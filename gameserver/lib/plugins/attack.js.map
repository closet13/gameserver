{"version":3,"sources":["../../src/plugins/attack.js"],"names":[],"mappings":";;;;;;;;;;;;;;AAIA,IAAI,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACpC,IAAI,MAAM,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC;AAC3C,IAAI,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;;IAEpB,MAAM;cAAN,MAAM;;AACG,aADT,MAAM,GACM;8BADZ,MAAM;;AAEJ,mCAFF,MAAM,6CAEI;KACX;;iBAHC,MAAM;;eAKD,iBAAC,EAAE,EAAE;AACR,gBAAI,CAAC,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;AAC1C,gBAAI,CAAC,EAAE,GAAG,EAAE,CAAC;AACb,gBAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACzC;;;eAGE,aAAC,IAAI,EAAE,MAAM,EAAE;;;AAGd,gBAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,EAAC,GAAG,EAAE,IAAI,CAAC,EAAE,EAAC,CAAC,CAAC;AAClD,gBAAI,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,EAAC,GAAG,EAAE,IAAI,CAAC,MAAM,EAAC,CAAC,CAAC;AACxD,gBAAI,QAAQ,GAAG,CAAC,CAAC;AACjB,gBAAI,IAAI,CAAC,KAAK,EAAE;AACZ,wBAAQ,GAAG,IAAI,CAAC,KAAK,CAAC;aACzB;;AAED,gBAAI,EAAE,IAAI,IAAI,EAAE;;AAEZ,kBAAE,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,GAAG,QAAQ,CAAC,CAAC;;AAEhE,oBAAI,EAAE,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;AACpB,sBAAE,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;;iBAEtB;;AAED,oBAAI,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;aACzC;SACJ;;;WAjCC,MAAM;GAAS,MAAM;;AAsC3B,MAAM,CAAC,OAAO,GAAG,GAAG,CAAC;;AAErB,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC","file":"attack.js","sourcesContent":["/**\n * Created by santi8ago8 on 11/11/15.\n */\n\nlet request = require('superagent');\nvar Plugin = require('./../plugin').Plugin;\nlet _ = require('lodash');\n\nclass Attack extends Plugin {\n    constructor() {\n        super();\n    }\n\n    enabled(gs) {\n        this.logger.info('Attack plugin enabled');\n        this.gs = gs;\n        this.on('s:hit', this.hit.bind(this));\n    }\n\n\n    hit(data, socket) {\n        //this.logger.info('hit', data);\n\n        let to = _.find(this.gs._players, {_id: data.to});\n        let from = _.find(this.gs._players, {_id: data.sender});\n        let multiply = 1;\n        if (data.skill) {\n            multiply = data.skill;\n        }\n\n        if (to && from) {\n\n            to.data.health -= Math.floor(1 + Math.random() * 10 * multiply);\n\n            if (to.data.health < 0) {\n                to.data.health = 0;\n                //TODO: dieeeee...\n            }\n\n            this.gs.plugins.Player.syncHealth(to);\n        }\n    }\n\n}\n\n\nAttack.version = 0.1; \n\nmodule.exports.Attack = Attack;"]}